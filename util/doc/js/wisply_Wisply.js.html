<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: wisply/wisply.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: wisply/wisply.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/* global $, bootbox, base64_decode */
/**
* It contains a reference to the Wisply.App object
* @global
* @see Wisply.App
*/
var wisply;

/**
* @file Encapsulates the functionality for all pages.
* @author Cristian Sima
*/

/**
* Encapsulates the functionality for all pages.
* @namespace Wisply
*/
var Wisply = function () {
  'use strict';

  /**
  * The constructor calls the init method
  * @class ShortcutManager
  * @memberof Wisply
  * @classdesc It manages the operations with the key shortcuts
  */
  function ShortcutManager() {
    this.defaultShortcuts = [{
      "type": "keyup",
      "key": "Alt+a",
      "callback": function () {
        wisply.goTo("/accessibility");
      }
    }, {
      "type": "keyup",
      "key": "Alt+h",
      "callback": function () {
        wisply.goTo("/");
      }
    }, {
      "type": "keyup",
      "key": "Alt+c",
      "callback": function () {
        wisply.goTo("/contact");
      }
    }];
  }
  ShortcutManager.prototype =
  /**
  * @lends Wisply.ShortcutManager
  */
  {
    /**
    * Called when the object is create. It activates the default shortcuts
    */
    init: function () {
      this.activate(this.defaultShortcuts);
    },
    /**
    * It activates the shortcuts received as parameters
    * @param  {array} shortcuts An array with the shortcuts to active. A shortcut has a event type, the shortcut combination of keys and the callback
    */
    activate: function (shortcuts) {
      var shortcut;
      for (var i = 0; i &lt; shortcuts.length; i++) {
        shortcut = shortcuts[i];
        $(document).bind(shortcut.type, shortcut.key, shortcut.callback);
      }
    }
  };

  /**
  * It creates the object
  * @class Message
  * @memberof Wisply
  * @classdesc It uses manages the operating regarding JavaScript messages
  */
  function Message() {
  }
  /**
  * @memberof Message
  */
  Message.prototype =
  /**
  * @lends Wisply.Message
  */
  {
    /**
    * It shows a succesful message
    * @param  {string} message The content of the message to be displayed
    */
    showSuccess: function (message) {
      this.show("&lt;div class='text-success'>Success&lt;/div>", message);
    },
    /**
    * It shows an error message
    * @param  {string} message The content of the message to be displayed
    */
    showError: function (message) {
      this.show("&lt;div class='text-warning'>Sorry&lt;/div>", message);
    },
    /**
    * It shows a message
    * @param  {string} title   The title of the message
    * @param  {string} content The content of the message
    */
    show: function (title, content) {
      this.dialog({
        title: title,
        message: content
      });
    },
    /**
    * It represents an adapter for the bootbox alert function. It shows an error message
    * @param  {object} args The arguments for the dialog
    * @see {@link http://bootboxjs.com/|Bootbox official website}
    */
    alert: function (args) {
      bootbox.dialog(args);
    },
    /**
    * It represents an adapter for the bootbox alert function. It shows a dialog message
    * @param  {object} args The arguments for the dialog
    * @see {@link http://bootboxjs.com/|Bootbox official website}
    */
    dialog: function (args) {
      bootbox.dialog(args);
    }
  };

  /**
  * The constructor creates a message and a shortcut objects
  * @property {Message}  message                    The reference to the message object
  * @property {ShortcutManager}  shortcutManager    The reference to the shortcut manager
  * @class App
  * @memberof Wisply
  * @classdesc It represents the main object of the website. It stores references to other objects and it provides the main functions
  */
  var App = function App() {
    /**
    * @access public
    */
    this.message = new Message();
    /**
    * @access public
    */
    this.shortcutManager = new ShortcutManager();
  };
  App.prototype =
  /**
  * @lends Wisply.App
  */
  {
    /**
    * It initiates the shorcuts' manager
    */
    init: function () {
      this.shortcutManager.init();
      this.solveHashProblem();
    },
    /**
     * The menu is fixed and thus when the user jumps to #something it does the menu overlapping the content
     */
    solveHashProblem: function () {

      function preventNavOverlap() {
        setTimeout(function() {scrollBy(0, -80);}, 10);
      }
      var hashTagActive = "";
      $(".scroll").click(function (event) {
          if(hashTagActive != this.hash) { //this will prevent if the user click several times the same link to freeze the scroll.
              event.preventDefault();
              //calculate destination place
              var dest = 0;
              if ($(this.hash).offset().top > $(document).height() - $(window).height()) {
                  dest = $(document).height() - $(window).height();
              } else {
                  dest = $(this.hash).offset().top;
              }
              //go to destination
              $('html,body').animate({
                  scrollTop: dest-80
              }, 500, 'swing');
              hashTagActive = this.hash;
              window.location.hash = this.hash;
          } else {
            preventNavOverlap();
          }
        });
        if(window.location.hash) {
            preventNavOverlap();
        }
        $(window).on('hashchange', function() {
          preventNavOverlap();
        });
    },
    /**
     * It preloads the loading image in the background and stores it in the browser cache
     */
    preloadLoadingImage: function() {
      var img = new Image();
        img.src = "/static/img/wisply/load.gif";
    },
    /**
    * It executes a JQuery post request, adding to it the xsrf token value
    * @param  {object} args Same arguments for as for a JQuery AJAX request
    * @see {@link http://api.jquery.com/jquery.ajax/|JQuery AJAX API}
    */
    executePostAjax: function (args) {
      if (typeof args.data === 'undefined') {
        args.data = {};
      }
      args.dataType = "text";
      args.method = args.type = "POST";
      args.data._xsrf = this.getXSRF();
      $.ajax(args);
    },
    /**
     * It activates the bootstrap tooltips
     */
    activateTooltip: function () {
      $('[data-toggle="tooltip"]').tooltip();
    },
    getXSRF : function() {
      var xsrf,
      xsrflist,
      value;
      xsrf = $.cookie("_xsrf");
      xsrflist = xsrf.split("|");
      value = base64_decode(xsrflist[0]);
      return value;
    },
    /**
    * It refreshes the page
    * @param  {number} delayTime The amount of time in ms to delay the refresh
    */
    reloadPage: function (delayTime) {
      if (typeof size === 'undefined') {
      } else {
        if(delayTime === "now") {
          delayTime = 0;
        }
      }
      setTimeout(function () {
        location.reload();
      }, delayTime);
    },
    /**
    * It transforms a HTML object in the loading icon for Wisply
    * @param  {string} idElement The id of the element
    * @param  {string} size      The size of the loading icon. It can be small (for 20px), medium (for 55px) and large (for 110px)
    */
    showLoading: function (idElement, size) {
      var element = $(idElement), HTML;
      HTML = this.getLoadingImage(size);
      element.html(HTML);
    },
    /**
        * It gets the HTML of the loading image
        * @param  {string} size      The size of the loading icon. It can be small (for 20px), medium (for 55px) and large (for 110px)
        * @return {string} The HTML for Wisply loading image
        */
    getLoadingImage: function(size) {
      /**
      * It returns the dimension in pixels acording to string type
      * @param  {string} size The demension of the image. It can be small (for 20px), medium (for 55px) and large (for 110px)
      * @return {int}      The dimension in pixels
      */
      function getDimension(size) {
        var px = 0;
      switch (size) {
        case "small":
        px = 20;
        break;
        case "medium":
        px = 55;
        break;
        case "big":
        px = 110;
        break;
      }
      return px;
    }

    /**
    * It returns the HTML code for the loading element
    * @param  {number} dimension The size of the image in px
    * @return {string}           The HTML code for loading element
    */
    function getHTML(dimension) {
      return "&lt;img src='/static/img/wisply/load.gif' style='height: " + dimension + "px; width: " + dimension + "px' />";
    }
    var dimension;

    if (typeof size === 'undefined') {
      size = "small";
    }
    dimension = getDimension(size);
    return getHTML(dimension);
  },
    /**
    * It redirects the account to a certain page
    * @param  {string} address The address of the page
    */
    goTo: function (address) {
      document.location = address;
    },
    /**
    * It adds a connection to Wisply
    * @param {Connection} connection The Connection object
    */
    addConnection: function (connection) {
      this.connection = connection;
    }
  };
  return {
       App: App
   };
};
$(document).ready(function() {
  "use strict";
  var module = new Wisply();
  wisply = new module.App();
  wisply.init();
});
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Accounts.Account.html">Account</a></li><li><a href="Accounts.Manager.html">Manager</a></li><li><a href="Administration.Admin.html">Admin</a></li><li><a href="Connection.Connection.html">Connection</a></li><li><a href="FunctionalityInstitution.Manager.html">Manager</a></li><li><a href="Harvest.HarvestConnection.html">HarvestConnection</a></li><li><a href="Harvest.History.html">History</a></li><li><a href="Harvest.StageManager.html">StageManager</a></li><li><a href="HarvestList.DecisionManager.html">DecisionManager</a></li><li><a href="HarvestList.GUI.html">GUI</a></li><li><a href="HarvestProcess.DecisionManager.html">DecisionManager</a></li><li><a href="HarvestProcess.Indicator.html">Indicator</a></li><li><a href="HarvestProcess.StageGUI.html">StageGUI</a></li><li><a href="HarvestProcess.WisplyCounter.html">WisplyCounter</a></li><li><a href="Institutions.GUI.html">GUI</a></li><li><a href="Institutions.Institution.html">Institution</a></li><li><a href="Institutions.Manager.html">Manager</a></li><li><a href="Login.Form.html">Form</a></li><li><a href="Register.Form.html">Form</a></li><li><a href="Repositories.GUI.html">GUI</a></li><li><a href="Repositories.Manager.html">Manager</a></li><li><a href="Repositories.Repository.html">Repository</a></li><li><a href="TyperModule.Typer.html">Typer</a></li><li><a href="Websockets.Connection.html">Connection</a></li><li><a href="Websockets.Gui.html">Gui</a></li><li><a href="WikierModule.Wikier.html">Wikier</a></li><li><a href="Wisply.App.html">App</a></li><li><a href="Wisply.Message.html">Message</a></li><li><a href="Wisply.ShortcutManager.html">ShortcutManager</a></li></ul><h3>Events</h3><ul><li><a href="AccountsManager.html#event:confirmDelete">confirmDelete</a></li><li><a href="Connection.html#event:FireLogoutUser">FireLogoutUser</a></li></ul><h3>Namespaces</h3><ul><li><a href="Accounts.html">Accounts</a></li><li><a href="Administration.html">Administration</a></li><li><a href="Connection.html">Connection</a></li><li><a href="FunctionalityInstitution.html">FunctionalityInstitution</a></li><li><a href="Harvest.html">Harvest</a></li><li><a href="HarvestList%25250DIt%252520holds%252520the%252520functionality%252520to%252520see%252520a%252520live%252520list%252520of%252520repositories.html">HarvestListIt holds the functionality to see a live list of repositories</a></li><li><a href="HarvestProcess.html">HarvestProcess</a></li><li><a href="Institutions.html">Institutions</a></li><li><a href="Login.html">Login</a></li><li><a href="Register.html">Register</a></li><li><a href="Repositories.html">Repositories</a></li><li><a href="TyperModule.html">TyperModule</a></li><li><a href="Websockets.html">Websockets</a></li><li><a href="WikierModule.html">WikierModule</a></li><li><a href="Wisply.html">Wisply</a></li></ul><h3>Global</h3><ul><li><a href="global.html#analyse">analyse</a></li><li><a href="global.html#changeURL">changeURL</a></li><li><a href="global.html#disableModifyURL">disableModifyURL</a></li><li><a href="global.html#enableModifyURL">enableModifyURL</a></li><li><a href="global.html#end">end</a></li><li><a href="global.html#getCounter">getCounter</a></li><li><a href="global.html#init">init</a></li><li><a href="global.html#initExistingProcess">initExistingProcess</a></li><li><a href="global.html#initNewProcess">initNewProcess</a></li><li><a href="global.html#paint">paint</a></li><li><a href="global.html#paintIdentificationDetails">paintIdentificationDetails</a></li><li><a href="global.html#perform">perform</a></li><li><a href="global.html#setCurrentCounter">setCurrentCounter</a></li><li><a href="global.html#stop">stop</a></li><li><a href="global.html#wisply">wisply</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0-dev</a> on Tue Oct 06 2015 12:47:44 GMT+0100 (BST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
