<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: source/list.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: source/list.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/* global jQuery, wisply */
var sources;

(function ($) {
    'use strict';

    /**
     * It represents a source
     * @param {number} id   The id of the source
     * @param {string} name The name of the source
     */
    function Source(id, name) {
        this.id = id;
        this.name = name;
    }

    /**
     * It encapsulets the functionality for the sources
     * The constructor activates the listeners
     */
    function Sources() {
        this.activateListeners();
    }
    Sources.prototype = {
        /**
         * It activates the listener for deleting a source
         */
        activateListeners: function () {
            $(".deleteSourceButton").click(confirmDelete);
        },
        /**
         * It is called when the user wants to delete a source. It asks for confirmation
         * @param  {Source} source The reference to the source object
         */
        confirmDelete: function (source) {
            var msg = this.getDialogMessage(source);
            wisply.message.dialog(msg);
        },
        /**
         * It returns the object which contain the arguments for the confirmation dialog
         * @param  {[type]} source The source object
         * @return {[type]}        The arguements for dialog
         * @see http://bootboxjs.com/
         */
        getDialogMessage: function (source) {
            var buttons,
                cancelButton,
                msg,
                mainButton;

            cancelButton = {
                label: "Cancel",
                className: "btn-default",
                callback: function () {
                    this.modal('hide');
                }
            };
            mainButton = {
                label: "Delete",
                className: "btn-primary",
                callback: function () {
                    sources.delete(source);
                }
            };
            buttons = {
                "cancel": cancelButton,
                "main": mainButton
            };
            msg = {
                title: "Please confirm!",
                message: "The source &lt;b>" + source.name + "&lt;/b> will be permanently removed. Are you sure?",
                onEscape: true,
                buttons: buttons
            };
            return msg;
        },
        /**
         * It delets a source
         * @param  {[type]} source The source object
         */
        delete: function (source) {
          var request,
          successCallback,
          errorCallback;

          /**
           * The callback called when the source has been deleted. It shows a message and reloads the page in 2 seconds
           */
          successCallback =  function () {
              wisply.message.showSuccess("The source has been removed! Refreshing page...");
              wisply.reloadPage(2000);
          };

          /**
           * The callback called when there was a problem. It shows a message
           */
          errorCallback = function () {
              wisply.message.showError("There was a problem with your request!");
          };

          request = {
            "url": '/admin/sources/delete/' + source.id,
            "success": successCallback,
            "error": errorCallback
          };
          wisply.executePostAjax(request);
        }
    };

    /**
     * It is called when the user clicks the delete button. It creates the source button and asks for confirmation
     * @param  {event} e The event generated
     */
    function confirmDelete(e) {
        e.preventDefault();
        var instance,
            name,
            id,
            source;
        instance = $(this);
        id = instance.data("id");
        name = instance.data("name");
        source = new Source(id, name);
        sources.confirmDelete(source);
    }

    /**
     * It is called when the page loads. It creates the sources object
     */
    function initSources() {
        sources = new Sources();
    }
    $(document).ready(initSources);
}(jQuery, wisply, sources));
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0-dev</a> on Wed Sep 16 2015 00:55:03 GMT+0100 (BST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
